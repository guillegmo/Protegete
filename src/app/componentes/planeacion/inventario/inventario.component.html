<ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="grupos-tab" data-bs-toggle="tab" data-bs-target="#grupos" type="button" role="tab" aria-controls="grupos" aria-selected="true">Crear Grupos y Lineas</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="producto-tab" data-bs-toggle="tab" data-bs-target="#producto" type="button" role="tab" aria-controls="producto" aria-selected="false">Crear Producto</button>
    </li>
    
  </ul>
  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="grupos" role="tabpanel" aria-labelledby="grupos-tab">
       
        <br>
        <div class="container">
            <div style="text-align:center">
                <h1><strong>Crear Linea y Grupo</strong></h1>                
            </div>
            <hr>
            <div class="row">
              <div class="col">
                <h2>Linea de Inventario</h2>
              </div>
                <div class="col">
                    <div class="form-floating mb-3">
                        <input
                          type="number"
                          class="form-control"
                          id="codigoLinea1"
                          placeholder="Codigo Linea"
                          autofocus
                          [(ngModel)]="codigoLinea"
                          (keyup.enter)="obtenerLinea(codigoLinea, 'nombreLinea1')"
                        />
                        <label for="floatingInput">Codigo Linea</label>
                    </div>
                </div>
                <div class="col">
                    <div class="form-floating mb-3">
                        <input
                          type="string"
                          class="form-control"
                          id="nombreLinea1"
                          placeholder="Nombre Linea"
                          [(ngModel)]="linea.nombreLinea"
                          (keyup.enter)="crearLinea('codigoGrupo1')"
                        />
                        <label for="floatingInput">Nombre Linea</label>
                      </div>
                </div>
            </div>

            <div class="row">
              <div class="col">
                <h2>Grupo de Inventario</h2>
              </div>
                <div class="col">
                    <div class="form-floating mb-3">
                        <input
                          type="number"
                          class="form-control"
                          id="codigoGrupo1"
                          placeholder="Codigo Grupo"
                          [(ngModel)]="codigoGrupo"
                          (keyup.enter)="obtenerGrupo(codigoLinea, 'nombreGrupo1')"
                        />
                        <label for="floatingInput">Codigo Grupo</label>
                      </div>
                </div>
                <div class="col">
                    <div class="form-floating mb-3">
                        <input
                          type="string"
                          class="form-control"
                          id="nombreGrupo1"
                          placeholder="Nombre Grupo"
                          [(ngModel)]="grupo.nombreGrupo"
                          (keyup.enter)="crearGrupo()"
                        />
                        <label for="floatingInput">Nombre Grupo</label>
                      </div>
                </div>
            </div>
            <br>
            
            <div class="container" style="text-align:right" *ngIf="editar">
              <button class="btn btn-primary" (click)="arreglo([linea.idLinea,linea.nombreLinea], [grupo.idGrupo,grupo.nombreGrupo, grupo.id_Linea])">Editar</button>
            </div>
            
            <div class="container">                
                <div style="text-align:center">
                    <br>
                    <table class="table">
                        <thead>
                          <tr>
                            <th scope="col">Codigo</th>
                            <th scope="col">Nombre</th>  
                            <th scope="col">Eliminar</th>          
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let registro of grupos">
                            <td>{{ registro.idGrupo }}</td>
                            <td>{{ registro.nombreGrupo }}</td>
                            <th>

                              <button class="btn btn danger" (click)="eliminarGrupo(registro.idGrupo)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" style="fill: red;transform: msFilter"><path d="M5 20a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8h2V6h-4V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2H3v2h2zM9 4h6v2H9zM8 8h9v12H7V8z"></path><path d="M9 10h2v8H9zm4 0h2v8h-2z"></path></svg></button>

                            </th>
                          </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

    </div>
    <div class="tab-pane fade" id="producto" role="tabpanel" aria-labelledby="producto-tab">
       
        <br>
        <div class="container">
            <div style="text-align:center">
                <h1><strong>Crear Producto</strong></h1>
            </div>
            <hr>
            <div class="row">
                <div class="col">
                    <div class="form-floating mb-3">
                        <input
                          type="number"
                          class="form-control"
                          id="floatingInput"
                          placeholder="Codigo Linea"
                          [(ngModel)]="codigoLinea"
                          (keyup.enter)="obtenerLinea(codigoLinea, 'codigoGrupo1.2')"
                        />
                        <label for="floatingInput">Codigo Linea</label>
                    </div>
                </div>
                <div class="col">
                  <div class="form-floating mb-3">
                    <input
                      type="string"
                      class="form-control"
                      id="nombreLinea1"
                      placeholder="Nombre Linea"
                      [(ngModel)]="linea.nombreLinea"
                      disabled
                    />
                    <label for="floatingInput">Nombre Linea</label>
                  </div>
                </div>
                <div class="col">
                  <h2>Ver listado Productos <label (click)= "openXL(listaProducto)" style="cursor: pointer" id="listaProductos"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal-medical" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 4a.5.5 0 0 1 .5.5v.634l.549-.317a.5.5 0 1 1 .5.866L9 6l.549.317a.5.5 0 1 1-.5.866L8.5 6.866V7.5a.5.5 0 0 1-1 0v-.634l-.549.317a.5.5 0 1 1-.5-.866L7 6l-.549-.317a.5.5 0 0 1 .5-.866l.549.317V4.5A.5.5 0 0 1 8 4zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                    <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
                    <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
                    </svg></label></h2>

                    <ng-template #listaProducto let-modal>
                      <div class="modal-header">
                        <h2 class="modal-title" id="exampleModalLabel">Lista de Producto</h2>
                        <button type="button" class="btn-close" aria-label="Close" (click)="cerrarModal()"></button>
                      </div>
                      <div class="modal-body">

                        <table class="table">
                          <thead>
                            <tr>
                              <th scope="col">Codigo Producto</th>
                              <th scope="col">Nombre Producto</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let registro of productos">
                              <td>{{ registro.idProducto }}</td>
                              <td>{{ registro.nombreProducto }}</td>                            
                            </tr>                            
                          </tbody>
                        </table>
                       
                      </div>
                    </ng-template>
                  
                </div>
                <div class="col"></div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="form-floating mb-3">
                        <input
                          type="number"
                          class="form-control"
                          id="codigoGrupo1.2"
                          placeholder="Codigo Grupo"
                          [(ngModel)]="codigoGrupo"
                          (keyup.enter)="obtenerGrupo(codigoLinea, 'codigoProducto1')"
                        />
                        <label for="floatingInput">Codigo Grupo</label>
                      </div>
                </div>
                <div class="col">
                  <div class="form-floating mb-3">
                    <input
                      type="string"
                      class="form-control"
                      id="nombreGrupo1"
                      placeholder="Nombre Grupo"
                      [(ngModel)]="grupo.nombreGrupo"
                      disabled
                    />
                    <label for="floatingInput">Nombre Grupo</label>
                  </div>
                </div>
                <div class="col"></div>
                <div class="col"></div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="form-floating mb-3">
                        <input
                          type="number"
                          class="form-control"
                          id="codigoProducto1"
                          placeholder="Codigo"
                          [(ngModel)]="codigoProducto"
                          (keyup.enter)="obtenerProducto(codigoGrupo, 'nombreProducto')"
                        />
                        <label for="floatingInput">Codigo</label>
                    </div>                                         
                </div>
                <div class="col">
                  <div class="form-floating mb-3">
                    <input
                      type="string"
                      class="form-control"
                      id="nombreProducto"
                      placeholder="Nombre Producto"
                      [(ngModel)]="producto.nombreProducto"
                      (keyup.enter)="saltarInput('codigoBarras')"
                    />
                    <label for="floatingInput">Nombre Producto</label>
                  </div>
                </div>
                <div class="col"></div>
                <div class="col"></div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="form-floating mb-3">
                        <input
                          type="string"
                          class="form-control"
                          id="codigoBarras"
                          placeholder="Codigo Barras"
                          [(ngModel)]="producto.codigoBarras"
                          (keyup.enter)="saltarInput('tipoProducto')"
                        />
                        <label for="floatingInput">Codigo Barras</label>
                    </div>                                         
                </div>
                <div class="col"></div>
                <div class="col"></div>
                <div class="col"></div>
            </div>
            <div class="row">
                <div class="col">
                    <select class="form-select" aria-label="tipo de producto" id="tipoProducto" [(ngModel)]="producto.tipoProducto" placeholder="Tipo de producto" (keyup.enter)="saltarInput('tipoIva')">
                        <option selected disabled>Tipo de Producto</option>
                        <option *ngFor="let registro of tipoProductos">{{ registro.nombreTipoProducto }}</option>      
                      </select>
                </div>
                <div class="col">
                    <button id="mas" class="btn btn-primary" (click)= "openLG(tipoProducto)">+</button>
                
                    <!-- Modal -->
                    <ng-template #tipoProducto let-modal>
                        <div class="modal-header">
                          <h2 class="modal-title" id="exampleModalLabel">Crear Nuevo Tipo de Producto</h2>
                          <button type="button" class="btn-close" aria-label="Close" (click)="cerrarModal()"></button>
                        </div>
                        <div class="modal-body">

                          <div class="container">
                            <div class="row">
                              <div class="col">
                                <div class="form-floating mb-3">
                                  <input
                                    type="string"
                                    class="form-control"
                                    id="tipoProducto"
                                    placeholder="Crear Nuevo Tipo de Producto"
                                    [(ngModel)]="tipoProductos.nombreTipoProducto"
                                    
                                  />
                                  <label for="floatingInput">Nombre Tipo de Producto</label>
                                </div> 
                              </div>
                              <div class="col">
                                <div class="form-check">
                                  <input class="form-check-input" type="radio" name="flexRadioDefault" id="afirmativo" value ="Si" [(ngModel)]="afirmativo" checked>
                                  <label class="form-check-label" for="flexRadioDefault1">
                                   Maneja Inventario
                                  </label>
                                </div>
                                <div class="form-check">
                                  <input class="form-check-input" type="radio" name="flexRadioDefault" id="afirmativo" value="No" [(ngModel)]="afirmativo">
                                  <label class="form-check-label" for="flexRadioDefault2">
                                    No Maneja Inventario
                                  </label>
                                </div>
                              </div>
                            </div>
                            <div style="text-align:center">
                              <button class="btn btn-primary" (click)="crearTipoProducto()">Crear</button>
                            </div>
                          </div>
                         
                        </div>
                      </ng-template>
                </div>                   

                <div class="col">
                    <select class="form-select" aria-label="tipo de iva" id="tipoIva" [(ngModel)]="producto.tipoIva" (keyup.enter)="saltarInput('unidadMedida')">
                      <option selected disabled>Tipo de Iva</option>
                      <option *ngFor="let registro of iva">{{ registro.nombreIva }}</option>
                    </select>
                </div>
                <div class="col">
                  <button id="mas" class="btn btn-primary" (click)= "openLG(tipoIva)">+</button>
              
                  <!-- Modal -->
                  <ng-template #tipoIva let-modal>
                      <div class="modal-header">
                        <h2 class="modal-title" id="exampleModalLabel">Crear Nuevo Iva</h2>
                        <button type="button" class="btn-close" aria-label="Close" (click)="cerrarModal()"></button>
                      </div>
                      <div class="modal-body">

                          <div class="container">
                            <div class="row">
                              <div class="col">
                                <div class="form-floating mb-3">
                                  <input
                                    type="string"
                                    class="form-control"
                                    id="nombreiva"
                                    placeholder="Nombre Nuevo Iva"
                                    [(ngModel)]="iva.nombreIva"
                                  />
                                  <label for="floatingInput">Nombre Nuevo Iva</label>
                                </div>
                              </div>
                              <div class="col">
                                <div class="form-floating mb-3">
                                  <input
                                    type="number"
                                    class="form-control"
                                    id="porcentajeiva"
                                    placeholder="Porcentaje de Iva"
                                    [(ngModel)]="iva.porcentajeIva"
                                  />
                                  <label for="floatingInput">Porcentaje de Iva</label>
                                </div>
                              </div>
                            </div>
                            <div style="text-align:center">
                              <button class="btn btn-primary" (click)="crearIva()">Crear</button>
                            </div>
                          </div>
                       
                      </div>
                    </ng-template>
              </div>    
            </div>
            <br>
            <div class="row">
                <div class="col">
                    <select class="form-select" aria-label="unidad de medida" id="unidadMedida" [(ngModel)]="producto.unidadMedida" (keyup.enter)="saltarInput('costoCompra')">
                        <option selected disabled>Unidad de Medida</option>
                        <option *ngFor="let registro of unidadMedida">{{ registro.nombreUnidadMedida }} - {{ registro.siglaUnidadMedida }}</option>
                      </select>
                </div>
                <div class="col">
                  <button id="mas" class="btn btn-primary" (click)= "openLG(tipoUnidadMedida)">+</button> 
              
                  <!-- Modal -->
                  <ng-template #tipoUnidadMedida let-modal>
                      <div class="modal-header">
                        <h2 class="modal-title" id="exampleModalLabel">Crear Unidad de Medida</h2>
                        <button type="button" class="btn-close" aria-label="Close" (click)="cerrarModal()"></button>
                      </div>
                      <div class="modal-body">
                        <div class="row">
                          <div class="col">
                            <div class="form-floating mb-3">
                              <input
                                type="string"
                                class="form-control"
                                id="nombreUnidadMedida"
                                placeholder="Nombre Unindad de Medida"
                                [(ngModel)]="unidadMedida.nombreUnidadMedida"
                              />
                              <label for="floatingInput">Nombre Unidad de Medida</label>
                            </div>                            
                          </div>
                          <div class="col">
                            <div class="form-floating mb-3">
                              <input
                                type="string"
                                class="form-control"
                                id="siglaUnidadMedida"
                                placeholder="Sigla Unidad Medida"
                                [(ngModel)]="unidadMedida.siglaUnidadMedida"
                              />
                              <label for="floatingInput">Sigla Unidad de Medida</label>
                            </div>  
                          </div>
                        </div>     
                          
                          <div style="text-align:center">
                            <button class="btn btn-primary" (click)="crearUnidadMedida()">Crear</button>
                          </div>                      
                       
                      </div>
                    </ng-template>
              </div>
              <div class="col"></div>
              <div class="col"></div>  
            </div>
            <br>
            <div class="row">
                <div class="col">
                    <div class="form-floating mb-3">
                        <input
                          type="number"
                          class="form-control"
                          id="costoCompra"
                          placeholder="Costo Compra"
                          [(ngModel)]="producto.costoCompra"
                          (keyup.enter)="saltarInput('stockMinimo')"
                        />
                        <label for="floatingInput">Costo Compra</label>
                      </div>
                </div>
                <div class="col">
                  <div class="form-floating mb-3">
                    <input
                      type="Number"
                      class="form-control"
                      id="stockMinimo"
                      placeholder="Stock Minimo"
                      [(ngModel)]="producto.stockMinimo"
                      (keyup.enter)="saltarInput('diasAnticipacion')"
                    />
                    <label for="floatingInput">Stock Minimo</label>
                  </div>
                </div>
                <div class="col">
                  <div class="form-floating mb-3">
                    <input
                      type="number"
                      class="form-control"
                      id="diasAnticipacion"
                      placeholder="Dias Anticipacion"
                      [(ngModel)]="producto.diasAnticipacion"
                      (keyup.enter)="saltarInput('botonP')"
                    />
                    <label for="floatingInput">Dias Anticipacion</label>
                </div>
                </div>
                <div class="col"></div>
            </div>

            <div style="text-align:center" *ngIf="boton==true">
              <button id="botonP" class="btn btn-primary" (click)="crearProducto()">{{ tituloBoton }}</button>
            </div>
            <div style="text-align:center" *ngIf="boton==false">
              <button id="botonP" class="btn btn-primary" (click)="arregloProducto([producto.idProducto, producto.nombreProducto, producto.codigoBarras, producto.tipoProducto, producto.tipoIva, producto.unidadMedida, producto.costoCompra, producto.stockMinimo, producto.diasAnticipacion, producto.id_Grupo])">{{ tituloBoton }}</button>
            </div>
        </div>
        
    </div>
  </div>